# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Duration is a blockchain-based charitable giving platform (Give Protocol) built with React, TypeScript, and Solidity smart contracts targeting the Moonbeam Network.

## Essential Commands

### Development
```bash
npm run dev          # Start Vite dev server (port 5173)
npm run lint         # Run ESLint
npm run build        # Production build (TypeScript + Vite)
```

### Smart Contracts
```bash
npm run compile              # Compile Solidity contracts
npm run test                 # Run Hardhat tests
npm run deploy:moonbase      # Deploy contracts to Moonbase Alpha testnet
npm run deploy:verification  # Deploy VolunteerVerification contract
npm run deploy:distribution  # Deploy CharityScheduledDistribution contract
```

### Testing
```bash
npm test                     # Run Hardhat smart contract tests
npm run test:e2e            # Run Cypress E2E tests (if configured)
```

## Architecture Overview

### Frontend Architecture
- **Pages**: Route components in `/src/pages/` organized by feature (charity/, donor/, volunteer/, admin/)
- **Components**: Reusable UI in `/src/components/` with subdirectories for feature-specific components
- **Hooks**: Custom React hooks in `/src/hooks/` including web3-specific hooks in `/src/hooks/web3/`
- **Contexts**: Global state management via React Context (Auth, Web3, Settings, Toast)
- **API Layer**: Supabase client and queries in `/src/lib/`

### Smart Contract Architecture
- **DurationDonation.sol**: Main donation contract handling direct, scheduled, and portfolio donations
- **CharityScheduledDistribution.sol**: Manages scheduled charity distributions
- **VolunteerVerification.sol**: Handles volunteer hour verification and NFT minting
- **DistributionExecutor.sol**: Executes scheduled distributions

### Key Patterns
1. **Web3 Integration**: Uses both ethers.js v6 and viem for blockchain interactions
2. **Transaction Forms**: Reusable transaction components in `/src/components/web3/`
3. **Multi-language Support**: i18n configured with 12+ languages in `/src/i18n/resources/`
4. **Type Safety**: Comprehensive TypeScript types in `/src/types/`
5. **Error Handling**: Global error boundary and transaction tracking hooks

## Development Notes

### Environment Setup
Create a `.env` file with required variables:
- `VITE_SUPABASE_URL` and `VITE_SUPABASE_ANON_KEY` for backend
- `VITE_MOONBASE_RPC_URL` for blockchain connection
- Private keys for contract deployment (never commit!)

### Working with Smart Contracts
1. Contracts are in `/contracts/` directory
2. Compiled artifacts go to `/src/contracts/[ContractName].sol/`
3. Always run `npm run compile` after contract changes
4. Test thoroughly before deploying to testnet

### State Management
- Authentication state managed by AuthContext
- Web3 wallet connection handled by Web3Context
- Use React Query for server state (charity data, donations)
- Local state for UI-only concerns

### Common Development Tasks
- Adding a new page: Create in `/src/pages/`, add route in `/src/routes/`
- Adding translations: Update all language files in `/src/i18n/resources/`
- Modifying contracts: Update Solidity, compile, update TypeScript types, redeploy
- Testing blockchain features: Use local Hardhat node with `npm run node`